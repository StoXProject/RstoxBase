<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Assignment of biotic hauls to acoustic PSUs by layer — DefineBioticAssignment • RstoxBase</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Assignment of biotic hauls to acoustic PSUs by layer — DefineBioticAssignment"><meta property="og:description" content="This function defines the BioticAssignment process data, linking biotic Hauls with acoustic PSUs by Layer."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RstoxBase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.24</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/StoXProject/RstoxBase/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Assignment of biotic hauls to acoustic PSUs by layer</h1>
    <small class="dont-index">Source: <a href="https://github.com/StoXProject/RstoxBase/blob/HEAD/R/Define.R" class="external-link"><code>R/Define.R</code></a></small>
    <div class="hidden name"><code>DefineBioticAssignment.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function defines the <code><a href="BioticAssignment.html">BioticAssignment</a></code> process data, linking biotic Hauls with acoustic PSUs by Layer.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">DefineBioticAssignment</span><span class="op">(</span>
  <span class="va">processData</span>,
  UseProcessData <span class="op">=</span> <span class="cn">FALSE</span>,
  DefinitionMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Manual"</span>, <span class="st">"Stratum"</span>, <span class="st">"Radius"</span>, <span class="st">"EllipsoidalDistance"</span>,
    <span class="st">"DeleteAllAssignments"</span>, <span class="st">"ResourceFile"</span><span class="op">)</span>,
  <span class="va">StoxBioticData</span>,
  FileName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">StratumPolygon</span>,
  <span class="va">AcousticPSU</span>,
  LayerDefinition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FunctionParameter"</span>, <span class="st">"FunctionInput"</span><span class="op">)</span>,
  LayerDefinitionMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WaterColumn"</span>, <span class="st">"HighestResolution"</span>, <span class="st">"Resolution"</span>,
    <span class="st">"LayerTable"</span><span class="op">)</span>,
  Resolution <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span>,
  LayerTable <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span>,
  AcousticLayer <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">StoxAcousticData</span>,
  Radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span>,
  MinNumberOfHauls <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span>,
  Distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span>,
  TimeDifference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span>,
  BottomDepthDifference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span>,
  LongitudeDifference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span>,
  LatitudeDifference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>

    <div id="ref-sections">
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>processData</dt>
<dd><p>The current data produced by a previous instance of the function.</p></dd>
<dt>UseProcessData</dt>
<dd><p>Logical: If TRUE use the existing function output in the process.</p></dd>
<dt>DefinitionMethod</dt>
<dd><p>Character: A string naming the method to use, one of "Stratum", assign all stations of each stratum to all acoustic PSUs; "Radius", to assign all stations within the radius given in <code>Radius</code> to each acoustic PSU; and "EllipsoidalDistance" to provide <code>MinNumberOfHauls</code>, <code>Distance</code>, <code>TimeDifference</code>, <code>BottomDepthDifference</code>, <code>LongitudeDifference</code>, <code>LatitudeDifference</code>, specifying the axes of an ellipsoid inside which to assign stations to acoustic PSUs, and "ResourceFile" to read a project.xml file from StoX 2.7.</p></dd>
<dt>StoxBioticData</dt>
<dd><p>The <code><a href="https://rdrr.io/pkg/RstoxData/man/StoxBioticData.html" class="external-link">StoxBioticData</a></code> data (defined in RstoxData).</p></dd>
<dt>FileName</dt>
<dd><p>The path to the StoX 2.7 project.xml file to read "bioticassignment", "suassignment" and "psustratum" from, in the case that <code>DefinitionMethod</code> is "ResourceFile".</p></dd>
<dt>StratumPolygon</dt>
<dd><p>The <code><a href="StratumPolygon.html">StratumPolygon</a></code> process data.</p></dd>
<dt>AcousticPSU</dt>
<dd><p>The <code><a href="AcousticPSU.html">AcousticPSU</a></code> process data.</p></dd>
<dt>LayerDefinition</dt>
<dd><p>The method to use for defining the Layers, one of <code>FunctionParameter</code> to define the Layers on the fly in this function, or <code>FunctionInput</code> to import Layer process data from a previously run process by <code>AcousticLayer</code>.</p></dd>
<dt>LayerDefinitionMethod</dt>
<dd><p>See <code><a href="DefineAcousticLayer.html">DefineAcousticLayer</a></code></p></dd>
<dt>Resolution</dt>
<dd><p>Numeric: A single numeric giving the thickness of the layers.</p></dd>
<dt>LayerTable</dt>
<dd><p>A table of Layer name, MinLayerDepth in meters and MaxLayerDepth in meters, defining the Layers.</p></dd>
<dt>AcousticLayer</dt>
<dd><p>The <code><a href="AcousticLayer.html">AcousticLayer</a></code> process data.</p></dd>
<dt>StoxAcousticData</dt>
<dd><p>The <code><a href="https://rdrr.io/pkg/RstoxData/man/StoxAcousticData.html" class="external-link">StoxAcousticData</a></code> data (defined in RstoxData).</p></dd>
<dt>Radius</dt>
<dd><p>Numeric: The radius inside which to assign biotic stations to each acoustic PSU.</p></dd>
<dt>MinNumberOfHauls</dt>
<dd><p>For DefinitionMethod "EllipsoidalDistance": Integer minimum number of hauls selected inside the ellipsoid. If the number of hauls inside the ellispoid is lower than the <code>MinNumberOfHauls</code>, the <code>MinNumberOfHauls</code> closest Hauls will be used (in ellipsoidal distance).</p></dd>
<dt>Distance</dt>
<dd><p>For DefinitionMethod "EllipsoidalDistance": The semi axis of the ellipsoid representing distance in nautical miles.</p></dd>
<dt>TimeDifference</dt>
<dd><p>For DefinitionMethod "EllipsoidalDistance": The semi axis of the ellipsoid representing time difference in hours.</p></dd>
<dt>BottomDepthDifference</dt>
<dd><p>For DefinitionMethod "EllipsoidalDistance": The semi axis of the ellipsoid representing difference in bottom depth in meters.</p></dd>
<dt>LongitudeDifference</dt>
<dd><p>For DefinitionMethod "EllipsoidalDistance": The semi axis of the ellipsoid representing difference in longitude in degrees.</p></dd>
<dt>LatitudeDifference</dt>
<dd><p>For DefinitionMethod "EllipsoidalDistance": The semi axis of the ellipsoid representing difference in latitude in degrees.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of StoX data type <code><a href="BioticAssignment.html">BioticAssignment</a></code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The <em>DefineBioticAssignment</em> function creates a list of which biotic hauls are assigned to each acoustic primary sampling unit (PSU) and assignment layer. An <em>assignment layer</em> is made up of one or more <em>layers</em>. The assigned biotic hauls are given the default weighting factor of 1. The list of assigned biotic stations will in another function be used to make a total combined length frequency distribution from all the individual haul distributions that have been assigned.</p>
<p>In addition to the option of modifying assignments manually through the StoX graphically user interface, several automatic assignment methods are available. The automated methods are applied by assignment layer on the biotic stations that are associated with each assignment layer. By default, the function parameter <em>UseProcessData</em> is set to true, ensuring that assignment from previous execution is availabe upon execution. UseProcessData may be set to false to redo or update assignemts.</p>
<p>Layer definitions needed for assignment can be done in two ways using the function parameter:</p>
<p><strong>LayerDefinition</strong></p>
<p>The available parameters are:
<em>FunctionInput</em> which utelizes input <code><a href="AcousticLayer.html">AcousticLayer</a></code> process data generated in a previous process. This object contains the layer definitions</p>
<p>alternatively,</p>
<p><em>FunctionParameter</em> which use function input data type <code>AcousticData</code> and function parameter <em>LayerDefinitionMethod</em>. The available methods are:</p>
<p><em>Watercolomn</em> method which defines one layer for the entire watercolumn
<em>HighestResolution</em> method which makes the highest possible number of layers based on the resolution in the input AcousticData.
<em>Resolution</em> method is assosiated with function parameter <em>Resolution</em> which gives the desired thickness (in meters) of the layers.</p>
  
<p>The available automatic assignment methods are:</p>
<p><strong>Stratum</strong></p>
<p>All biotic hauls within each stratum  are assigned to all the acoustic PSUs of the stratum.</p>
<p><strong>Radius</strong></p>
<p>All biotic stations within the given radius (function parameter <em>Radius</em> (nautical miles)) of one or more of the elementary distance sampling units (EDSU) that makes up a PSU, are assigned to that PSU. The start position of both the biotic station and the EDSU is used for distance calculations. The method does not take into consideration whether the biotic station is in the same stratum as the PSU or even outside the boundaries of the strata system. The function parameter <em>MinNumberOfHauls</em> set a minimum number of hauls for each assignment. This implies that the search for hauls may go beyond the given radius.</p>
<p><strong>EllipsoidalDistance</strong></p>
<p>This assignment method uses the ellipsoidal distance <a href="https://doi.org/10.1016/j.fishres.2007.07.013" class="external-link">(Johnsen and Iilende, 2007, equation 8)</a>.  All biotic stations that fulfills the selection criteria (scalar product f &lt;=1) on one or more EDSUs of a PSU, will be assigned to the PSU. The scalar product of the method is calculated as:</p>
<p>$$f(d,t,b,l,o)=\left(\frac{\Delta d}{r_d}\right)^2 + \left(\frac{\Delta t}{r_t}\right)^2 +
\left(\frac{\Delta b}{r_b}\right)^2 + \left(\frac{\Delta l}{r_l}\right)^2 +
\left(\frac{\Delta o}{r_0}\right)^2$$</p>
<p>where:</p>
<p>\(f\) = scalar product</p>
<p>\(\Delta d\) = great circle distance between the acoustic EDSU position  and the biotic station (nautical miles). Start positions for the biotic station and the EDSU are used.</p>
<p>\(\Delta t\) = time difference between the acoustic EDSU and the biotic station recordings (hours). Start time for the biotic station and the EDSU are used.</p>
<p>\(\Delta b\) = difference in bottom depth at the locations of the acoustic EDSU and the biotic station (meters). For the EDSU, the bottom depth is calculated as the average depth from the minimum and maximum depth recorded over the EDSU distance. The biotic station depth is calculated as the average at the start and stop of the station.</p>
<p>\(\Delta l\) = difference in latitude between the acoustic EDSU and the biotic station (degrees)</p>
<p>\(\Delta o\) = difference in longitude between the acoustic EDSU and the biotic station (degrees)</p>
<p>\(r_d\) = reference value for great circle distance difference (nautical miles). Defined by function parameter <em>Distance</em>)</p>
<p>\(r_t\) = reference value for time difference (hours). Defined by function parameter <em>TimeDifference</em>)</p>
<p>\(r_b\) = reference value for bottom depth difference (meters). Defined  by function parameter <em>BottomDepthDifference</em>)</p>
<p>\(r_l\) = reference value for latitude difference (degrees). Defined by function parameter <em>LatitudeDifference</em>)</p>
<p>\(r_o\) = reference value for longitude difference (degrees). Defined by function parameter <em>LongitudeDifference</em>)</p>
<p>The function parameter <em>MinNumberOfHauls</em> can override the requirement to fulfill the selection criteria (scalar product f &lt;=1) if the number of assigned hauls are lower than the MinNumberOfHauls parameter value. Hauls with a scalar product value closest to the minimum selection criteria, will be included in the assignment list to ensure that a minimum number of stations are assigned.</p>
<p>NOTE! The end user will get a warning if one or more acoustic PSUs have not been assigned any biotic hauls.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Johnsen E., Iilende T., 2007, Factors affecting the diel variation in commercial CPUE of Namibian hake. Can new information improve standard survey estimates?, Fisheries Research 88 (2007) p70 to 79, <a href="https://doi.org/10.1016/j.fishres.2007.07.013" class="external-link">https://doi.org/10.1016/j.fishres.2007.07.013</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="BioticAssignmentWeighting.html">BioticAssignmentWeighting</a></code> for weighting BioticAssignment.</p></div>
    </div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Arne Johannes Holmin, Ibrahim Umar, Sindre Vatnehol, Edvin Fuglebakk, Aasmund Skaalevik, Esmael Musema Hassen, Espen Johnsen, Atle Totland, Norwegian Institute of Marine Research.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

